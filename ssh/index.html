<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>SSH Essentials  - Akhil Raghav</title><meta name="description" content="About SSH tunneling and port forwarding snippets and utilsTable of Contents SOCK5 tunnel everything: Local port forwardiing:Remote port forewardingSSH local-port-forwardingSSH local-port-forwarding. You want to be able to access a service or website that your firewall is preventing you from accessing but you know it is available from the remote server.CommandsDefinition  ssh -fNL LOCAL-IP:LOCAL-PORT:REMOTE-IP:REMOTE-PORT username@remote-hostssh -fNL LOCAL-IP:LOCAL-PORT:REMOTE-URL:REMOTE-PORT username@remote-hostExamples# Example 1# If you want to access a service that is running on the remote server port 8888,# but there is a firewall that is preventing you from accessing the port 8888 from the browser.# For example you would like to do this from the browser but cannot, remote-host:8888# After running the following command you can access the service from your local browser, localhost:8080$ ssh -NL 0.0.0.0:8080:localhost:8888 username@remote-host# Example 2# If you are not able to access google.com from your local system but the remote server is able to access it.# After running the following command you can access the google.com from your local browser, localhost:8080$ ssh -NL 0.0.0.0:8080:google.com:80 username@remote-host Option Combination -L: Local Port forward and open a remote shell.-NL: Local Port forward but do not open a remote shell-fNL: Local Port forward, do not open remote shell, and send this into the background.SSH Remote port forwardingOne use case for using remote port-forwarding is if a local machine is stuck behind a vpn or firewall and it needs to be accessed by a remote machine. Simple ssh will suffice but we use autossh to keep the connection reliably open for a long period of time.CommandsAllow SSH into first machine (local) from second (remote) and (third part) machine Open up ssh port on the first machine, such that it can be accessed by the second machine. We will use the first, second and third to mean the same machine in all examples.The following command should be run on the first machine Autossh requires two additional echo ports on the second machine. Autossh uses these two ports to check if the connection is alive or not. So in all, the second machine must open three ports in the firewall for autossh to work. For this example we use the following ports:ACCESS_PORT = 8080ECHO_PORT_1 = 20000ECHO_PORT_2 = ECHO_PORT_1 + 1 (20001) (This is done automatically by autossh if not manually set).The command that needs to be run on the first machine is of the following form:# Usage$ autossh -M ECHO_PORT_1 -fNR IP-ON-SECOND:ACCESS_PORT:IP-ON-FIRST:SSH-PORT second-user@second-host# Example$ autossh -M 20000 -fNR 0.0.0.0:8080:localhost:22 second-user@second-hostThe command that needs to be run on the second machine to acces the first machine via ssh is of the following form:# Usage$ ssh first-user@second-host -p ACCESS_PORT# Example$ ssh first-user@locahost -p 8080### OR $ ssh first-user@0.0.0.0 -p 8080 The command that needs to be run by a third machine trying to gain access to the first machine via the second machine is of the following form:# Usage$ ssh first-user@second-host -p ACCESS_PORT# Example$ ssh first-user@second-host -p 8080"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="./../ssh/"><link rel="stylesheet" href="./../assets/css/style.css?v=d753c1564dc63920bc2505474e7618f2"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"./../ssh/index.html"},"headline":"SSH Essentials ","datePublished":"2022-04-25T07:56","dateModified":"2022-04-25T16:05","image":{"@type":"ImageObject","url":"./../media/posts/2/Screenshot-from-2022-04-25-11-47-02.png","height":1003,"width":2045},"description":"About SSH tunneling and port forwarding snippets and utilsTable of Contents SOCK5 tunnel everything: Local port forwardiing:Remote port forewardingSSH local-port-forwardingSSH local-port-forwarding. You want to be able to access a service or website that your firewall is preventing you from accessing but you know it is available from the remote server.CommandsDefinition  ssh -fNL LOCAL-IP:LOCAL-PORT:REMOTE-IP:REMOTE-PORT username@remote-hostssh -fNL LOCAL-IP:LOCAL-PORT:REMOTE-URL:REMOTE-PORT username@remote-hostExamples# Example 1# If you want to access a service that is running on the remote server port 8888,# but there is a firewall that is preventing you from accessing the port 8888 from the browser.# For example you would like to do this from the browser but cannot, remote-host:8888# After running the following command you can access the service from your local browser, localhost:8080$ ssh -NL 0.0.0.0:8080:localhost:8888 username@remote-host# Example 2# If you are not able to access google.com from your local system but the remote server is able to access it.# After running the following command you can access the google.com from your local browser, localhost:8080$ ssh -NL 0.0.0.0:8080:google.com:80 username@remote-host Option Combination -L: Local Port forward and open a remote shell.-NL: Local Port forward but do not open a remote shell-fNL: Local Port forward, do not open remote shell, and send this into the background.SSH Remote port forwardingOne use case for using remote port-forwarding is if a local machine is stuck behind a vpn or firewall and it needs to be accessed by a remote machine. Simple ssh will suffice but we use autossh to keep the connection reliably open for a long period of time.CommandsAllow SSH into first machine (local) from second (remote) and (third part) machine Open up ssh port on the first machine, such that it can be accessed by the second machine. We will use the first, second and third to mean the same machine in all examples.The following command should be run on the first machine Autossh requires two additional echo ports on the second machine. Autossh uses these two ports to check if the connection is alive or not. So in all, the second machine must open three ports in the firewall for autossh to work. For this example we use the following ports:ACCESS_PORT = 8080ECHO_PORT_1 = 20000ECHO_PORT_2 = ECHO_PORT_1 + 1 (20001) (This is done automatically by autossh if not manually set).The command that needs to be run on the first machine is of the following form:# Usage$ autossh -M ECHO_PORT_1 -fNR IP-ON-SECOND:ACCESS_PORT:IP-ON-FIRST:SSH-PORT second-user@second-host# Example$ autossh -M 20000 -fNR 0.0.0.0:8080:localhost:22 second-user@second-hostThe command that needs to be run on the second machine to acces the first machine via ssh is of the following form:# Usage$ ssh first-user@second-host -p ACCESS_PORT# Example$ ssh first-user@locahost -p 8080### OR $ ssh first-user@0.0.0.0 -p 8080 The command that needs to be run by a third machine trying to gain access to the first machine via the second machine is of the following form:# Usage$ ssh first-user@second-host -p ACCESS_PORT# Example$ ssh first-user@second-host -p 8080","author":{"@type":"Person","name":"Akhil Raghav","url":"./../authors/akhil-raghav/"},"publisher":{"@type":"Organization","name":"Akhil Raghav"}}</script></head><body class="lines"><div class="container lines lines--right"><header class="header"><a href="./../index.html" class="logo">Akhil Raghav</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu">Menu</button><ul class="navbar__menu"></ul></nav></header><main class="main"><article class="post"><header class="post__inner post__header"><h1 class="post__title">SSH Essentials </h1><div class="post__meta"><div class="post__meta__left"><a href="./../authors/akhil-raghav/index.html" class="invert post__author" rel="author" title="Akhil Raghav">Akhil Raghav</a></div><div class="post__meta__right"><time datetime="2022-04-25T07:56" class="post__date">April 25, 2022</time><div class="post__updated">Updated on <time datetime="2022-04-25T07:56" class="post__date">April 25, 2022</time></div></div></div></header><figure class="post__featured-image"><div class="post__featured-image__inner is-img-loading"><img src="./../media/posts/2/Screenshot-from-2022-04-25-11-47-02.png" srcset="./../media/posts/2/responsive/Screenshot-from-2022-04-25-11-47-02-xs.png 384w, ./../media/posts/2/responsive/Screenshot-from-2022-04-25-11-47-02-sm.png 600w, ./../media/posts/2/responsive/Screenshot-from-2022-04-25-11-47-02-md.png 768w, ./../media/posts/2/responsive/Screenshot-from-2022-04-25-11-47-02-lg.png 1200w, ./../media/posts/2/responsive/Screenshot-from-2022-04-25-11-47-02-xl.png 1600w" sizes="(min-width: 37.5em) 1600px, 80vw" loading="eager" height="1003" width="2045" alt=""></div></figure><div class="post__inner"><div class="post__entry"><h1>About </h1><p>SSH tunneling and port forwarding snippets and utils</p><h2>Table of Contents </h2><ul><li>SOCK5 tunnel everything: </li><li>Local port forwardiing:</li><li>Remote port forewarding</li></ul><h2>SSH local-port-forwarding</h2><p>SSH local-port-forwarding. You want to be able to access a service or website that your firewall is preventing you from accessing but you know it is available from the remote server.</p><h3>Commands</h3><ul style="list-style-type: square;"><li>Definition  </li></ul><pre data-sourcepos="6:1-9:3"><code>ssh -fNL LOCAL-IP:LOCAL-PORT:REMOTE-IP:REMOTE-PORT username@remote-host
ssh -fNL LOCAL-IP:LOCAL-PORT:REMOTE-URL:REMOTE-PORT <a href="mailto:username@remote-host">username@remote-host</a></code></pre><ul style="list-style-type: square;"><li>Examples<pre><span class="pl-c"># Example 1</span>
<span class="pl-c"># If you want to access a service that is running on the remote server port 8888,</span>
<span class="pl-c"># but there is a firewall that is preventing you from accessing the port 8888 from the browser.</span>
<span class="pl-c"># For example you would like to do this from the browser but cannot, remote-host:8888</span>
<span class="pl-c"># After running the following command you can access the service from your local browser, localhost:8080</span>
$ ssh -NL 0.0.0.0:8080:localhost:8888 username@remote-host


<span class="pl-c"># Example 2</span>
<span class="pl-c"># If you are not able to access google.com from your local system but the remote server is able to access it.</span>
<span class="pl-c"># After running the following command you can access the google.com from your local browser, localhost:8080</span>
$ ssh -NL 0.0.0.0:8080:google.com:80 <a href="mailto:username@remote-host">username@remote-host</a></pre><p> </p></li><li>Option Combination <ul style="list-style-type: square;"><li><code>-L</code>: Local Port forward and open a remote shell.</li><li><code>-NL</code>: Local Port forward but do not open a remote shell</li><li><code>-fNL</code>: Local Port forward, do not open remote shell, and send this into the background.</li></ul></li></ul><hr><h2>SSH Remote port forwarding</h2><p>One use case for using remote port-forwarding is if a local machine is stuck behind a vpn or firewall and it needs to be accessed by a remote machine. Simple ssh will suffice but we use autossh to keep the connection reliably open for a long period of time.</p><h3>Commands</h3><p><span style="color: #34495e;"><em><strong>Allow SSH into first machine (local) from second (remote) and (third part) machine </strong></em></span></p><p>Open up ssh port on the first machine, such that it can be accessed by the second machine. We will use the first, second and third to mean the same machine in all examples.</p><ul><li style="list-style-type: none;"><ul><li>The following command should be run on the first machine </li><li>Autossh requires two additional echo ports on the second machine. Autossh uses these two ports to check if the connection is alive or not. So in all, the second machine must open three ports in the firewall for autossh to work. For this example we use the following ports:<ul><li>ACCESS_PORT = 8080</li><li>ECHO_PORT_1 = 20000</li><li>ECHO_PORT_2 = ECHO_PORT_1 + 1 (20001) (This is done automatically by autossh if not manually set).</li></ul></li><li>The command that needs to be run on the first machine is of the following form:<pre><span class="pl-c"># Usage</span>
$ autossh -M ECHO_PORT_1 -fNR IP-ON-SECOND:ACCESS_PORT:IP-ON-FIRST:SSH-PORT second-user@second-host

<span class="pl-c"># Example</span>
$ autossh -M 20000 -fNR 0.0.0.0:8080:localhost:22 <a href="mailto:second-user@second-host">second-user@second-host</a></pre></li><li>The command that needs to be run on the second machine to acces the first machine via ssh is of the following form:<pre><span class="pl-c"># Usage</span>
$ ssh first-user@second-host -p ACCESS_PORT

<span class="pl-c"># Example</span>
$ ssh first-user@locahost -p 8080
<span class="pl-c">### OR </span>
$ ssh first-user@0.0.0.0 -p 8080</pre><p> </p></li><li>The command that needs to be run by a third machine trying to gain access to the first machine via the second machine is of the following form:<pre><span class="pl-c"># Usage</span>
$ ssh first-user@second-host -p ACCESS_PORT

<span class="pl-c"># Example</span>
$ ssh first-user@second-host -p 8080</pre></li></ul></li></ul><h2>SSH SOCKS proxy</h2><p dir="auto" data-sourcepos="2:1-2:366">We can use ssh-local-port-forwarding to have access to a single REMOTE IP:PORT being redirected to a LOCAL IP:PORT. However port forwarding can forward all REMOTE IP*:PORT* combinations to a LOCAL PORT. This would mean that if you setup a proxy on your LOCAL PORT, then accessing <code>abc.xyz</code> on your LOCAL machine would redirect you to <code>abc.xyz</code> on the REMOTE machine.</p><p dir="auto" data-sourcepos="4:1-4:52">The bash commands to make this work are shown below.</p><h3 class="align-left" dir="auto" data-sourcepos="7:1-7:11">Sources</h3><ul dir="auto" data-sourcepos="8:1-11:0"><li data-sourcepos="8:1-8:99"><a href="https://askubuntu.com/questions/112177/how-do-i-tunnel-and-browse-the-server-webpage-on-my-laptop" rel="nofollow">https://askubuntu.com/questions/112177/how-do-i-tunnel-and-browse-the-server-webpage-on-my-laptop</a></li><li data-sourcepos="9:1-11:0"><a href="https://superuser.com/questions/819714/chrome-ssh-tunnel-forwarding" rel="nofollow">https://superuser.com/questions/819714/chrome-ssh-tunnel-forwarding</a></li></ul><h3 dir="auto" data-sourcepos="12:1-12:12">Commands</h3><ul dir="auto" data-sourcepos="13:1-15:0"><li data-sourcepos="13:1-13:59">Use one terminal and run the ssh port forwarding command.</li><li data-sourcepos="14:1-15:0">Use another terminal and open a browser using SOCKS proxy.</li></ul><h4 dir="auto" data-sourcepos="16:1-16:32">SSH Port Forward Everything</h4><ul dir="auto" data-sourcepos="17:1-18:121"><li data-sourcepos="17:1-17:29">The example uses port 8080.</li><li data-sourcepos="18:1-18:121">This command does not run in the background. You can lookup for <code>ssh --help</code> for running the command in the background.</li></ul><div class="highlight highlight-source-shell"><pre>$ ssh -ND 8080 username@remotehost</pre></div><h4 dir="auto" data-sourcepos="23:1-23:37">Browser Session with SOCKS Proxy</h4><ul dir="auto" data-sourcepos="24:1-27:204"><li data-sourcepos="24:1-24:80">Install Chromium browser which makes it easy to create a proxy server session.</li><li data-sourcepos="25:1-25:77">Create a proxy sessson with the localhost:PORT, the example uses port 8080.</li><li data-sourcepos="26:1-26:106">This command does not run in the background and opens a chromium browser session with the proxy enabled.</li><li data-sourcepos="27:1-27:204"><strong>Warning</strong>: Every URL that you access using this proxy session will be as if you are accessing them from the REMOTE Machine, therefore use this session specifically for the URLs that you intend to use.</li></ul><div class="highlight highlight-source-shell"><pre>$ sudo apt-get install chromium-browser
$ chromium-browser --proxy-server=<span class="pl-s"><span class="pl-pds">"</span>socks5://localhost:8080<span class="pl-pds">"</span></span></pre><p> </p></div></div><footer class="post__footer"><div class="post__tag-share"><div class="post__share"></div></div></footer></div></article></main><footer class="footer"><div class="footer__left"><div class="footer__copy">Akhil Raghav</div></div><button onclick="backToTopFunction()" id="backToTop" class="footer__bttop" aria-label="Back to top" title="Back to top"><svg><use xlink:href="./../assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script>window.publiiThemeMenuConfig = { mobileMenuMode: 'sidebar', animationSpeed: 300, submenuWidth: 'auto', doubleClickTime: 500, mobileMenuExpandableSubmenus: true, relatedContainerForOverlayMenuSelector: '.navbar', };</script><script defer="defer" src="./../assets/js/scripts.min.js?v=abc27c3e08d71a131b1f492b23530a68"></script><script>function publiiDetectLoadedImages () {
         var images = document.querySelectorAll('img[loading]:not(.is-loaded)');
         for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
               images[i].classList.add('is-loaded');
               images[i].parentNode.classList.remove('is-img-loading');
            } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
                  this.parentNode.classList.remove('is-img-loading');
               }, false);
            }
         }
      }
      publiiDetectLoadedImages();</script><script defer="defer" src="./../assets/js/quicklink.umd.js?v=81fe10ee7d67aefb93d57a5af679039d"></script><script>window.addEventListener('load', () =>{
      quicklink.listen();
      });</script></body></html>